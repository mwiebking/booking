import{o as h,j as e,r as p,n as x}from"./index-DtksbfGo.js";import{u as w}from"./useRouteContext-BZ2hYPtO.js";import{C as b,T as j,P as y}from"./TextInput-C2xXLxuY.js";const P="_container_178qn_1",R={container:P};function E(){const r=h(),o=()=>{r.navigate({to:"/dashboard-student"})};return e.jsx(Button,{type:"submit",onClick:o,children:"Go to About"})}function _(){const r=w({from:"/login"}),[o,t]=p.useState(""),d={bg:"var(--mantine-color-blue-light)",mt:"md"};async function m(f){f.preventDefault();const n=new FormData(document.querySelector("#login-form")),s=n.get("email"),g=n.get("password");t("");try{const{data:i,error:c}=await r.supabase.auth.signInWithPassword({email:s,password:g});if(c){console.error("Login error:",c.message),t("Login failed. Please check your email and password.");return}const{data:a,error:l}=await r.supabase.from("users").select("first_name, last_name, role").eq("email",s).single();if(l){console.error("Error fetching user details:",l.message),t("Unable to fetch user details. Please try again.");return}const u={email:s,firstName:a.first_name,lastName:a.last_name,role:a.role};r.setUserInfo(u),u.role==="teacher"?window.location.href="/dashboard-teacher":window.location.href="/dashboard-student"}catch(i){console.error("Unexpected error during login:",i.message),t("An unexpected error occurred. Please try again.")}}return e.jsx("div",{children:e.jsx(b,{className:R.container,...d,children:e.jsxs("form",{onSubmit:m,id:"login-form",children:[e.jsx(j,{label:"Email",placeholder:"email@gmail.com",name:"email",required:!0}),e.jsx(y,{label:"Password",placeholder:"Your password",name:"password",required:!0}),o&&e.jsx("div",{style:{color:"red",marginTop:"10px"},children:o}),e.jsx(E,{})]})})})}const I=x("/login")({component:v});function v(){return e.jsx("div",{children:e.jsx(_,{})})}export{I as Route};
