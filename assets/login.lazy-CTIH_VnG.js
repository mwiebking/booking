import{r as l,u as B,j as e,L as c,g as y,c as E}from"./index-Bkez-pS9.js";import{u as P}from"./useRouteContext-3bawUZ_j.js";import{C as v}from"./Container-CXP4Fl0D.js";import{T as k}from"./TextInput-CYsXIIhx.js";import{P as I}from"./PasswordInput-BbPuMfaV.js";import{C as N}from"./Checkbox-DkbborqA.js";import"./InputBase-CR9AXoA5.js";import"./use-resolved-styles-api-ChudHkTs.js";import"./CheckIcon-C2h7fTL_.js";const T="_container_13ohj_1",F="_LoginButton_13ohj_29",R="_PasswordInput_13ohj_51",W="_TextWrapper_13ohj_63",C="_textLabel_13ohj_73",D="_passwordLabel_13ohj_81",S="_forgotButton_13ohj_89",U="_registerButton_13ohj_113",O="_registerButton1_13ohj_139",t={container:T,LoginButton:F,PasswordInput:R,TextWrapper:W,textLabel:C,passwordLabel:D,forgotButton:S,registerButton:U,registerButton1:O};function q(){const n=P({from:"/login"}),[d,r]=l.useState(""),[x,s]=l.useState(""),[f,a]=l.useState(""),j=B(),_={bg:"var(--mantine-color-blue-light)",mt:"md"};async function b(w){w.preventDefault();const u=new FormData(document.querySelector("#login-form")),o=u.get("email"),m=u.get("password");r(""),s(""),a(""),o?o.endsWith("@cphbusiness.dk")||s("Kun brugere med @cphbusiness.dk kan logge ind"):s("Udfyld venligst din email"),m||a("Udfyld venligst din adgangskode");try{const{data:g,error:p}=await n.supabase.auth.signInWithPassword({email:o,password:m});if(p){console.error("Fejl ved login:",p.message),r("Fejl ved login, tjek venligst e-mail og kodeord");return}const{data:i,error:h}=await n.supabase.from("users").select("first_name, last_name, role").eq("email",o).single();if(h){console.error("Error fetching user details:",h.message),r("Unable to fetch user details. Please try again.");return}const L={email:o,firstName:i.first_name,lastName:i.last_name,role:i.role};n.setUserInfo(L),j.navigate("/..dashboard")}catch(g){console.error("Unexpected error during login:",g.message),r("An unexpected error occurred. Please try again.")}}return e.jsx("div",{children:e.jsxs(v,{classNames:{root:t.container},..._,children:[e.jsx("h1",{className:"start",style:{marginTop:"0px",marginBottom:"10px"},children:"Log ind"}),e.jsxs("form",{onSubmit:b,id:"login-form",children:[e.jsx(k,{label:"Email",classNames:{input:t.TextWrapper,label:t.textLabel},placeholder:"Email",name:"email",error:x,onFocus:()=>s("")}),e.jsx(I,{label:"Password",placeholder:"Adgangskode",classNames:{input:t.PasswordInput,label:t.passwordLabel},name:"password",error:f,onFocus:()=>a("")}),d&&e.jsx("div",{style:{color:"red",marginTop:"10px"},children:d}),e.jsx(c,{className:t.forgotButton,to:"/forgotpassword",children:e.jsxs("div",{children:[" ",e.jsx("p",{style:{fontWeight:"500"},children:"Glemt adgangskode?"})]})}),e.jsx(N,{label:"Husk mig",color:"#1098ad"}),e.jsx(c,{to:"/dashboard",children:e.jsx(y,{type:"submit",className:t.LoginButton,children:"LOG IND"})}),e.jsx(c,{className:t.registerButton,to:"/signup",children:e.jsxs("div",{className:t.registerButton1,children:[" ",e.jsx("p",{style:{fontWeight:"500"},children:"OPRET PROFIL"})]})})]})]})})}const X=E("/login")({component:A});function A(){return e.jsx("div",{children:e.jsx(q,{})})}export{X as Route};
