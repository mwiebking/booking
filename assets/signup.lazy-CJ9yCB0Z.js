import{r as y,u as v,j as r,L as B,c as E}from"./index-D8YpNUcb.js";import{u as R}from"./useRouteContext-DqhR0Bz5.js";import{C as S}from"./Container-Ceglx9Hc.js";import{T as c}from"./TextInput-CCCyOJw6.js";import{P as w}from"./PasswordInput-DNy7H8uJ.js";import{C as b}from"./Checkbox-Bll_0vNP.js";import{A as U}from"./Anchor-BLwvkbBG.js";import"./InputBase-C0PjgYJK.js";import"./use-input-props-gcEFTNs-.js";import"./use-resolved-styles-api-ccSGp1zG.js";import"./CheckIcon-CFVpqJdQ.js";function A(){const d=R({from:"/signup"}),[e,a]=y.useState({firstName:"",lastName:"",email:"",password:"",confirmPassword:""}),[p,f]=y.useState(""),j=v();async function N(l){l.preventDefault();const s=new FormData(document.querySelector("#signup-form")),g=s.get("firstName"),x=s.get("lastName"),n=s.get("email"),m=s.get("password"),u=s.get("confirmPassword"),C=s.get("notifyEmail")==="on",P=s.get("notifyText")==="on";a({firstName:"",lastName:"",email:"",password:"",confirmPassword:""}),f("");let t=!0;const o={};if(g||(o.firstName="Udfyld venligst dit fornavn",t=!1),x||(o.lastName="Udfyld venligst dit efternavn",t=!1),n?n.endsWith("@cphbusiness.dk")||(o.email="Kun brugere med @cphbusiness.dk kan tilmelde sig",t=!1):(o.email="Udfyld venligst din email",t=!1),m||(o.password="Udfyld venligst din adgangskode",t=!1),u||(o.confirmPassword="Tjek om kodeord matcher",t=!1),m!==u&&(o.confirmPassword="Kodeordet matcher ikke",t=!1),!t){a(o);return}try{const{data:h,error:D}=await d.supabase.from("users").select("email").eq("email",n).single();if(h){a({...o,email:"This email is already registered. Please log in."});return}const{data:W,error:k}=await d.supabase.auth.signUp({email:n,password:m});if(k){a({...o,password:"Sign-up failed. Please try again."});return}await d.supabase.from("users").insert({first_name:g,last_name:x,email:n,role:"student",email_notifications:C,sms_notifications:P}),f("Account created successfully! Please log in.")}catch{a({...o,general:"An unexpected error occurred. Please try again."})}}const i=l=>{a(s=>({...s,[l]:""}))};return r.jsx(S,{style:{width:"365px",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:r.jsxs("form",{id:"signup-form",style:{width:"100%",padding:"1.5rem",border:"1px solid #ddd",borderRadius:"8px",boxShadow:"0px 4px 6px rgba(0, 0, 0, 0.1)"},onSubmit:N,children:[r.jsx("h1",{style:{marginBottom:"20px"},children:"Opret Profil"}),r.jsx(c,{placeholder:"Fornavn",name:"firstName",radius:"xl",style:{marginBottom:"10px",borderColor:e.firstName?"red":"#ddd",borderWidth:e.firstName?"2px":"1px"},onChange:()=>i("firstName")}),e.firstName&&r.jsx("div",{style:{color:"red",marginBottom:"20px"},children:e.firstName}),r.jsx(c,{placeholder:"Efternavn",name:"lastName",radius:"xl",style:{marginBottom:"10px",borderColor:e.lastName?"red":"#ddd",borderWidth:e.lastName?"2px":"1px"},onChange:()=>i("lastName")}),e.lastName&&r.jsx("div",{style:{color:"red",marginBottom:"20px"},children:e.lastName}),r.jsx(c,{placeholder:"Email",name:"email",radius:"xl",style:{marginBottom:"10px",borderColor:e.email?"red":"#ddd",borderWidth:e.email?"2px":"1px"},onChange:()=>i("email")}),e.email&&r.jsx("div",{style:{color:"red",marginBottom:"20px"},children:e.email}),r.jsx(w,{placeholder:"Adgangskode",name:"password",radius:"xl",style:{marginBottom:"10px",borderColor:e.password?"red":"#ddd",borderWidth:e.password?"2px":"1px"},onChange:()=>i("password")}),e.password&&r.jsx("div",{style:{color:"red",marginBottom:"20px"},children:e.password}),r.jsx(w,{placeholder:"Bekræft adgangskode",name:"confirmPassword",radius:"xl",style:{marginBottom:"10px",borderColor:e.confirmPassword?"red":"#ddd",borderWidth:e.confirmPassword?"2px":"1px"},onChange:()=>i("confirmPassword")}),e.confirmPassword&&r.jsx("div",{style:{color:"red",marginBottom:"20px"},children:e.confirmPassword}),r.jsx(b,{label:"Vil gerne modtage notifikationer på SMS",name:"notifyText",radius:"md",style:{marginBottom:"20px"}}),r.jsx(b,{label:"Vil gerne modtage notifikationer på mail",name:"notifyEmail",radius:"md",style:{marginBottom:"20px"}}),e.general&&r.jsx("div",{style:{color:"red",marginBottom:"20px"},children:e.general}),p&&r.jsx("div",{style:{color:"green",marginBottom:"20px"},children:p}),r.jsx("button",{type:"submit",style:{display:"block",marginBottom:"20px",width:"100%",backgroundColor:"#1098AD",color:"#fff",padding:"10px 0",border:"none",borderRadius:"16px",cursor:"pointer"},children:"OPRET BRUGER"}),r.jsx(B,{to:"/login",children:r.jsx(U,{onClick:()=>j.navigate("../login"),style:{display:"block",textAlign:"center",color:"#1098AD",marginTop:"10px"},children:"Allerede en bruger? Log ind"})})]})})}const H=E("/signup")({component:T});function T(){return r.jsx("div",{children:r.jsx(A,{})})}export{H as Route};
