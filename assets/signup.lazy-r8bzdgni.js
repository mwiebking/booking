import{r as g,j as e,B as w,c as S}from"./index-Crsb3sVN.js";import{u as P}from"./useRouteContext-Cv1KHECf.js";import{C as v}from"./Container-BrYHtjWd.js";import{T as i}from"./TextInput-BKjDOVbt.js";import{P as T,C as d}from"./PasswordInput-BkRu5DvM.js";import"./use-input-props-CdUqtela.js";import"./use-resolved-styles-api-4d8eUp_l.js";const U="_container_8uoh1_1",_={container:U};function q(){const t=P({from:"/signup"}),[l,s]=g.useState(""),[c,m]=g.useState("");async function f(x){x.preventDefault();const r=new FormData(document.querySelector("#signup-form")),h=r.get("firstName"),y=r.get("lastName"),a=r.get("email"),b=r.get("password"),j=r.get("phoneNumber"),N=r.get("notifyEmail")==="on",E=r.get("notifyText")==="on";s(""),m("");try{const{data:o,error:n}=await t.supabase.from("users").select("email").eq("email",a).single();if(n&&n.code!=="PGRST116"){console.error("Error checking existing user:",n.message),s("An error occurred while checking user availability. Please try again.");return}if(o){s("This email is already registered. Please log in or use a different email.");return}const{data:D,error:u}=await t.supabase.auth.signUp({email:a,password:b});if(u){console.error("Sign-up error:",u.message),s("Sign-up failed. Please try again.");return}const{data:R,error:p}=await t.supabase.from("users").insert({first_name:h,last_name:y,email:a,phone_number:j||null,role:"student",email_notifications:N,sms_notifications:E});if(p){console.error("Error saving user details:",p.message),s("Unable to save user details. Please try again.");return}m("Account created successfully! Please log in.")}catch(o){console.error("Unexpected error during sign-up:",o.message),s("An unexpected error occurred. Please try again.")}}return e.jsx(v,{className:_.container,children:e.jsxs("form",{onSubmit:f,id:"signup-form",children:[e.jsx(i,{label:"First Name",placeholder:"John",name:"firstName",required:!0}),e.jsx(i,{label:"Last Name",placeholder:"Doe",name:"lastName",required:!0}),e.jsx(i,{label:"Email",placeholder:"email@gmail.com",name:"email",required:!0}),e.jsx(T,{label:"Password",placeholder:"Your password",name:"password",required:!0}),e.jsx(d,{label:"Notify me via email",name:"notifyEmail"}),e.jsx(d,{label:"Notify me via text",name:"notifyText"}),l&&e.jsx("div",{style:{color:"red",marginTop:"10px"},children:l}),c&&e.jsx("div",{style:{color:"green",marginTop:"10px"},children:c}),e.jsx(w,{type:"submit",children:"Sign Up"})]})})}const z=S("/signup")({component:C});function C(){return e.jsx("div",{children:e.jsx(q,{})})}export{z as Route};
