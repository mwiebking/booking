import{r as w,f as L,j as e,B as i,c as v}from"./index-Clk1ba7H.js";import{u as P}from"./useRouteContext-BHryblw0.js";import{C as j}from"./Container-Du4y_7Y3.js";import{T as y}from"./TextInput-Cbzf3ah1.js";import{P as B}from"./PasswordInput-D6WDxOzy.js";import{C as I}from"./Checkbox-6L8vJXhn.js";import"./InputBase-CXHR42bX.js";import"./Input-DjUrkIon.js";import"./use-input-props-kfxPeElf.js";import"./use-resolved-styles-api-C4wRqCm3.js";import"./CheckIcon-NS2ObLLJ.js";const N="_container_ee6v9_1",k="_LoginButton_ee6v9_15",C="_PasswordInput_ee6v9_26",E="_TextWrapper_ee6v9_32",R="_textLabel_ee6v9_37",T="_passwordLabel_ee6v9_41",D="_forgotButton_ee6v9_45",F="_registerButton_ee6v9_57",o={container:N,LoginButton:k,PasswordInput:C,TextWrapper:E,textLabel:R,passwordLabel:T,forgotButton:D,registerButton:F};function U(){const a=P({from:"/login"}),[l,t]=w.useState(""),n=L(),m={bg:"var(--mantine-color-blue-light)",mt:"md"};async function p(h){h.preventDefault(),console.log("Login form submitted");const c=new FormData(document.querySelector("#login-form")),r=c.get("email"),b=c.get("password");t("");try{console.log("Attempting to authenticate user with email:",r);const{data:u,error:g}=await a.supabase.auth.signInWithPassword({email:r,password:b});if(g){console.error("Login error:",g.message),t("Login failed. Please check your email and password.");return}console.log("User authenticated successfully");const{data:s,error:d}=await a.supabase.from("users").select("first_name, last_name, role").eq("email",r).single();if(d){console.error("Error fetching user details:",d.message),t("Unable to fetch user details. Please try again.");return}console.log("User details fetched successfully:",s);const _={email:r,firstName:s.first_name,lastName:s.last_name,role:s.role};a.setUserInfo(_),console.log("Redirecting to dashboard"),n.navigate("/booking/dashboard")}catch(u){console.error("Unexpected error during login:",u.message),t("An unexpected error occurred. Please try again.")}}function f(){console.log("Navigating to create profile page"),n.navigate("/booking/login")}function x(){console.log("Navigating to forgot password page"),n.navigate("/booking/forgotpassword")}return e.jsxs("div",{children:[e.jsx("h1",{children:"Log ind"}),e.jsx(j,{classNames:{root:o.container},...m,children:e.jsxs("form",{onSubmit:p,id:"login-form",children:[e.jsx(y,{label:"Email",classNames:{input:o.TextWrapper,label:o.textLabel},placeholder:"Email",name:"email",required:!0}),e.jsx(B,{label:"Password",placeholder:"Adgangskode",classNames:{input:o.PasswordInput,label:o.passwordLabel},name:"password",required:!0}),l&&e.jsx("div",{style:{color:"red",marginTop:"10px"},children:l}),e.jsx(i,{type:"button",className:o.forgotButton,onClick:x,children:"Glemt adgangskode?"}),e.jsx(I,{label:"Husk mig",color:"#1098ad"}),e.jsx(i,{type:"submit",className:o.LoginButton,children:"LOG IND"}),e.jsx(i,{type:"button",className:o.registerButton,onClick:f,children:"OPRET PROFIL"})]})})]})}const Q=v("/login")({component:W});function W(){return e.jsx("div",{children:e.jsx(U,{})})}export{Q as Route};
