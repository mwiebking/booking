import{r as y,u as P,j as r,c as E}from"./index-D_61FSkh.js";import{L as U}from"./link-WghK4Db8.js";import{u as R}from"./useRouteContext-BSI-4lgU.js";import{C as S}from"./Container-B3UkTvWC.js";import{T as d}from"./TextInput-BqaMs1V3.js";import{P as N}from"./PasswordInput-BCcJ5Uar.js";import{C as w}from"./Checkbox-pfspFZOY.js";import{A as T}from"./Anchor-KkqYgKy1.js";import"./InputBase-CUdyvZU0.js";import"./use-resolved-styles-api-Dmtf6xfm.js";import"./CheckIcon-C7ET61LP.js";import"./Text-C3VBjkVd.js";function A(){const l=R({from:"/signup"}),[e,a]=y.useState({firstName:"",lastName:"",phoneNumber:"",email:"",password:"",confirmPassword:""}),[c,f]=y.useState(""),j=P();async function v(m){m.preventDefault();const t=new FormData(document.querySelector("#signup-form")),x=t.get("firstName"),g=t.get("lastName"),u=t.get("phoneNumber"),n=t.get("email"),p=t.get("password"),h=t.get("confirmPassword"),C=t.get("notifyEmail")==="on",B=t.get("notifyText")==="on";a({firstName:"",lastName:"",phoneNumber:"",email:"",password:"",confirmPassword:""}),f("");let s=!0;const o={};if(x||(o.firstName="Udfyld venligst dit fornavn",s=!1),g||(o.lastName="Udfyld venligst dit efternavn",s=!1),u||(o.phoneNumber="Udfyld venligst dit telefonnummer",s=!1),n?n.endsWith("@cphbusiness.dk")||(o.email="Kun brugere med @cphbusiness.dk kan tilmelde sig",s=!1):(o.email="Udfyld venligst din email",s=!1),p||(o.password="Udfyld venligst din adgangskode",s=!1),h||(o.confirmPassword="Tjek om kodeord matcher",s=!1),p!==h&&(o.confirmPassword="Kodeordet matcher ikke",s=!1),!s){a(o);return}try{const{data:b,error:D}=await l.supabase.from("users").select("email").eq("email",n).single();if(b){a({...o,email:"This email is already registered. Please log in."});return}const{data:F,error:k}=await l.supabase.auth.signUp({email:n,password:p});if(k){a({...o,password:"Sign-up failed. User already exists."});return}await l.supabase.from("users").insert({first_name:x,last_name:g,phone_number:u,email:n,role:"student",email_notifications:C,sms_notifications:B}),f("Bruger Oprettet! Gå venligst til login siden.")}catch{a({...o,general:"An unexpected error occurred. Please try again."})}}const i=m=>{a(t=>({...t,[m]:""}))};return r.jsx(S,{style:{width:"365px",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:r.jsxs("form",{id:"signup-form",style:{width:"100%",padding:"1.5rem",border:"1px solid #ddd",borderRadius:"8px",boxShadow:"0px 4px 6px rgba(0, 0, 0, 0.1)"},onSubmit:v,children:[r.jsx("h1",{className:"start",style:{marginBottom:"20px",marginTop:"0px"},children:"Opret Profil"}),r.jsx(d,{placeholder:"Fornavn",name:"firstName",radius:"xl",style:{marginBottom:"10px",borderColor:e.firstName?"red":"#ddd",borderWidth:e.firstName?"2px":"1px"},onChange:()=>i("firstName")}),e.firstName&&r.jsx("div",{style:{color:"red",marginBottom:"20px"},children:e.firstName}),r.jsx(d,{placeholder:"Efternavn",name:"lastName",radius:"xl",style:{marginBottom:"10px",borderColor:e.lastName?"red":"#ddd",borderWidth:e.lastName?"2px":"1px"},onChange:()=>i("lastName")}),e.lastName&&r.jsx("div",{style:{color:"red",marginBottom:"20px"},children:e.lastName}),r.jsx(d,{placeholder:"Telefonnummer",name:"phoneNumber",radius:"xl",style:{marginBottom:"10px",borderColor:e.phoneNumber?"red":"#ddd",borderWidth:e.phoneNumber?"2px":"1px"},onChange:()=>i("phoneNumber")}),e.phoneNumber&&r.jsx("div",{style:{color:"red",marginBottom:"20px"},children:e.phoneNumber}),r.jsx(d,{placeholder:"Email",name:"email",radius:"xl",style:{marginBottom:"10px",borderColor:e.email?"red":"#ddd",borderWidth:e.email?"2px":"1px"},onChange:()=>i("email")}),e.email&&r.jsx("div",{style:{color:"red",marginBottom:"20px"},children:e.email}),r.jsx(N,{placeholder:"Adgangskode",name:"password",radius:"xl",style:{marginBottom:"10px",borderColor:e.password?"red":"#ddd",borderWidth:e.password?"2px":"1px"},onChange:()=>i("password")}),e.password&&r.jsx("div",{style:{color:"red",marginBottom:"20px"},children:e.password}),r.jsx(N,{placeholder:"Bekræft adgangskode",name:"confirmPassword",radius:"xl",style:{marginBottom:"10px",borderColor:e.confirmPassword?"red":"#ddd",borderWidth:e.confirmPassword?"2px":"1px"},onChange:()=>i("confirmPassword")}),e.confirmPassword&&r.jsx("div",{style:{color:"red",marginBottom:"20px"},children:e.confirmPassword}),r.jsx(w,{label:"Vil gerne modtage notifikationer på SMS",name:"notifyText",radius:"md",style:{marginBottom:"20px"}}),r.jsx(w,{label:"Vil gerne modtage notifikationer på mail",name:"notifyEmail",radius:"md",style:{marginBottom:"20px"}}),e.general&&r.jsx("div",{style:{color:"red",marginBottom:"20px"},children:e.general}),c&&r.jsx("div",{style:{color:"green",marginBottom:"20px"},children:c}),r.jsx("button",{type:"submit",style:{display:"block",marginBottom:"20px",width:"100%",backgroundColor:"#1098AD",color:"#fff",padding:"10px 0",border:"none",borderRadius:"16px",cursor:"pointer"},children:"OPRET BRUGER"}),r.jsx(U,{to:"/login",children:r.jsx(T,{onClick:()=>j.navigate("./login"),style:{display:"block",textAlign:"center",color:"#1098AD",marginTop:"10px"},children:"Allerede en bruger? Log ind"})})]})})}const Q=E("/signup")({component:W});function W(){return r.jsx("div",{children:r.jsx(A,{})})}export{Q as Route};
