import{r as d,j as e,m as b,n as j}from"./index-DaZ-CF9V.js";import{u as y}from"./useRouteContext-BZC3Pjhs.js";import{C as P,T as g,P as v}from"./TextInput-BX4LCzYq.js";const E="_container_178qn_1",_={container:E};function L(){const a=y({from:"/login"}),[h,p]=d.useState(""),[n,r]=d.useState(""),f={bg:"var(--mantine-color-blue-light)",mt:"md"};async function x(o){o.preventDefault();const i=new FormData(document.querySelector("#login-form")),s=i.get("email"),w=i.get("password");r("");try{const{data:l,error:c}=await a.supabase.auth.signInWithPassword({email:s,password:w});if(c){console.error("Login error:",c.message),r("Login failed. Please check your email and password.");return}const{data:t,error:m}=await a.supabase.from("users").select("first_name, last_name, status").eq("email",s).single();if(m){console.error("Error fetching user details:",m.message),r("Unable to fetch user details. Please try again.");return}const u={email:s,firstName:t.first_name,lastName:t.last_name,role:t.status};a.setUserInfo(u),u.role==="teacher"?window.location.href="/teacher-dashboard":window.location.href="/student-dashboard"}catch(l){console.error("Unexpected error during login:",l.message),r("An unexpected error occurred. Please try again.")}}return e.jsx("div",{children:e.jsx(P,{className:_.container,...f,children:e.jsxs("form",{onSubmit:x,id:"login-form",children:[e.jsx(g,{value:h,onChange:o=>p(o.target.value),label:"Name",placeholder:"John",name:"name"}),e.jsx(g,{label:"Email",placeholder:"email@gmail.com",name:"email"}),e.jsx(v,{label:"Password",placeholder:"Your password",name:"password"}),n&&e.jsx("div",{style:{color:"red",marginTop:"10px"},children:n}),e.jsx(b,{type:"submit",children:"Login"})]})})})}const R=j("/login")({component:C});function C(){return e.jsx("div",{children:e.jsx(L,{})})}export{R as Route};
