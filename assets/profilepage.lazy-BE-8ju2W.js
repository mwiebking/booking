import{r as d,a as F,b as Y,j as e,d as k,f as $,C as H,P as J,G as K,B as E,c as Q}from"./index-D_61FSkh.js";import{B,A as X}from"./NavbarNested-B2frjePs.js";import{u as Z}from"./useRouteContext-BSI-4lgU.js";import{C as ee}from"./Container-B3UkTvWC.js";import{C as se}from"./Center-DbSVlK4U.js";import{S as l}from"./Space-BOQ-Pei9.js";import{T as C}from"./TextInput-BqaMs1V3.js";import{u as te,a as re}from"./use-resolved-styles-api-Dmtf6xfm.js";import{I as D,a as ne}from"./InputBase-CUdyvZU0.js";import{A as ae}from"./Anchor-KkqYgKy1.js";import{C as le}from"./Checkbox-pfspFZOY.js";import"./link-WghK4Db8.js";import"./Text-C3VBjkVd.js";import"./CheckIcon-C7ET61LP.js";const oe={multiple:!1},T=d.forwardRef((s,t)=>{const{onChange:a,children:n,multiple:m,accept:I,name:c,form:h,resetRef:i,disabled:x,capture:g,inputProps:j,...y}=F("FileButton",oe,s),o=d.useRef(null),r=()=>{var f;!x&&((f=o.current)==null||f.click())},p=f=>{a(m?Array.from(f.currentTarget.files):f.currentTarget.files[0]||null)};return Y(i,()=>{o.current&&(o.current.value="")}),e.jsxs(e.Fragment,{children:[n({onClick:r,...y}),e.jsx("input",{style:{display:"none"},type:"file",accept:I,multiple:m,onChange:p,ref:k(t,o),name:c,form:h,capture:g,...j})]})});T.displayName="@mantine/core/FileButton";const ie=({value:s})=>e.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Array.isArray(s)?s.map(t=>t.name).join(", "):s==null?void 0:s.name}),ue={valueComponent:ie},R=$((s,t)=>{const a=F("FileInput",ue,s),{unstyled:n,vars:m,onChange:I,value:c,defaultValue:h,multiple:i,accept:x,name:g,form:j,valueComponent:y,clearable:o,clearButtonProps:r,readOnly:p,capture:v,fileInputProps:f,rightSection:V,size:A,placeholder:O,component:U,resetRef:G,classNames:P,styles:S,...L}=a,b=d.useRef(null),{resolvedClassNames:z,resolvedStyles:M}=te({classNames:P,styles:S,props:a}),[u,_]=re({value:c,defaultValue:h,onChange:I,finalValue:i?[]:null}),w=Array.isArray(u)?u.length!==0:u!==null,W=V||(o&&w&&!p?e.jsx(H,{...r,variant:"subtle",onClick:()=>_(i?[]:null),size:A,unstyled:n}):null);d.useEffect(()=>{var N;(Array.isArray(u)&&u.length===0||u===null)&&((N=b.current)==null||N.call(b))},[u]);const q=y;return e.jsx(T,{onChange:_,multiple:i,accept:x,name:g,form:j,resetRef:k(b,G),disabled:p,capture:v,inputProps:f,children:N=>e.jsx(D,{component:U||"button",ref:t,rightSection:W,...N,...L,__staticSelector:"FileInput",multiline:!0,type:"button",pointer:!0,__stylesApiProps:a,unstyled:n,size:A,classNames:P,styles:S,children:w?e.jsx(q,{value:u}):e.jsx(ne.Placeholder,{__staticSelector:"FileInput",classNames:z,styles:M,children:O})})})});R.classes=D.classes;R.displayName="@mantine/core/FileInput";const ce=R;function pe(){var h,i,x,g,j,y,o;const s=Z({from:"/profilepage"});d.useEffect(()=>{console.log(s)},[s]);const[t,a]=d.useState({firstName:((h=s.userInfo)==null?void 0:h.first_name)||"",lastName:((i=s.userInfo)==null?void 0:i.lastName)||"",email:((x=s.userInfo)==null?void 0:x.email)||"",phone:((g=s.userInfo)==null?void 0:g.phoneNumber)||"",role:((j=s.userInfo)==null?void 0:j.role)||"",avatar:((y=s.userInfo)==null?void 0:y.profilePicture)||null,notifications:((o=s.userInfo)==null?void 0:o.emailNotifications)||!1}),[n,m]=d.useState(!1),I=async()=>{const{supabase:r,setUserInfo:p}=s,{error:v}=await r.from("users").update({first_name:t.firstName,last_name:t.lastName,phone_number:t.phone,email_notifications:t.notifications}).eq("id",s.userInfo.id);if(v){alert("Fejl ved opdatering af profiloplysninger. Prøv igen senere."),console.error("Error updating profile:",v);return}s.setUserInfo({...s.userInfo,firstName:t.firstName,lastName:t.lastName,phoneNumber:t.phone}),alert("Dine nye profiloplysninger er blevet gemt!"),m(!1)},c=r=>p=>{a({...t,[r]:p.target.value})};return e.jsxs(ee,{size:"lg",style:{height:"100vh",display:"flex"},children:[e.jsx(B,{}),e.jsx(se,{style:{flex:1,height:"80%",justifyContent:"center",paddingTop:"2rem"},children:e.jsxs(J,{withBorder:!0,shadow:"md",p:30,radius:"md",style:{width:"364px",height:"710px",display:"flex",flexDirection:"column",justifyContent:"center"},children:[e.jsx("h1",{className:"start",children:"Profil Info"}),e.jsx(l,{h:"md"}),e.jsx(C,{label:"Navn",value:s.userInfo.firstName,onChange:c("firstName"),radius:"xl",disabled:!n}),e.jsx(l,{h:"sm"}),e.jsx(C,{label:"Efternavn",value:s.userInfo.lastName,onChange:c("lastName"),radius:"xl",disabled:!n}),e.jsx(l,{h:"sm"}),e.jsx(C,{label:"Telefon nr.",value:s.userInfo.phoneNumber,onChange:c("phone"),radius:"xl",disabled:!n}),e.jsx(l,{h:"sm"}),e.jsx(C,{label:"Email",value:s.userInfo.email,disabled:!0,radius:"xl"}),e.jsx(l,{h:"sm"}),e.jsx(C,{label:"Studerende, eller underviser",value:s.userInfo.role,disabled:!0,radius:"xl"}),e.jsx(l,{h:"md"}),e.jsxs(K,{position:"center",spacing:"xs",children:[e.jsx(X,{size:50,radius:"xl",src:t.avatar||"https://via.placeholder.com/150",alt:"Avatar"}),n&&e.jsx(ce,{placeholder:"UPLOAD",accept:"image/*",onChange:r=>a({...t,avatar:r?URL.createObjectURL(r):null}),radius:"xl"})]}),e.jsx(l,{h:"md"}),e.jsx(ae,{href:"/changepassword",style:{color:"#1098AD"},children:"Skift Adgangskode"}),e.jsx(l,{h:"md"}),n&&e.jsx(le,{label:"Vil gerne modtage notifikationer på email",checked:t.notifications,style:{color:"#1098AD"},onChange:r=>a({...t,notifications:r.target.checked})}),e.jsx(l,{h:"md"}),n?e.jsx(E,{fullWidth:!0,onClick:I,color:"cyan",radius:"xl",style:{height:"33px"},children:"GEM OPDATERING"}):e.jsx(E,{fullWidth:!0,onClick:()=>m(!0),color:"cyan",radius:"xl",style:{height:"33px"},children:"REDIGER PROFIL"}),e.jsx(l,{h:"xs"})]})})]})}const Pe=Q("/profilepage")({component:fe});function fe(){return e.jsxs("div",{style:{display:"flex",height:"100vh",width:"100%"},children:[e.jsxs("div",{style:{width:300,height:"100%"},children:[e.jsx(B,{})," "]}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:"2rem"},children:e.jsx(pe,{})})]})}export{Pe as Route};
