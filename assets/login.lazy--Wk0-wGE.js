import{r as L,f as v,j as e,B as i,c as j}from"./index-BiJi3uwm.js";import{u as B}from"./useRouteContext-xrn4Lf3c.js";import{C as P}from"./Container-Bt-b6z5W.js";import{T as y}from"./TextInput-QV-akN2t.js";import{P as C}from"./PasswordInput-CsX7s3a7.js";import{C as k}from"./Checkbox-CDLLNdRQ.js";import"./InputBase-CRZR3YvE.js";import"./Input-s0Rkpycx.js";import"./use-input-props-Sl8yNFvH.js";import"./use-resolved-styles-api-DqES57gp.js";import"./CheckIcon-GMa0bEmq.js";const I="_container_ee6v9_1",N="_LoginButton_ee6v9_15",E="_PasswordInput_ee6v9_26",R="_TextWrapper_ee6v9_32",T="_textLabel_ee6v9_37",D="_passwordLabel_ee6v9_41",F="_forgotButton_ee6v9_45",U="_registerButton_ee6v9_57",o={container:I,LoginButton:N,PasswordInput:E,TextWrapper:R,textLabel:T,passwordLabel:D,forgotButton:F,registerButton:U};function W(){const a=B({from:"/login"}),[l,t]=L.useState(""),n=v(),m={bg:"var(--mantine-color-blue-light)",mt:"md"};async function p(_){_.preventDefault(),console.log("Login form submitted");const c=new FormData(document.querySelector("#login-form")),r=c.get("email"),b=c.get("password");t("");try{console.log("Attempting to authenticate user with email:",r);const{data:u,error:d}=await a.supabase.auth.signInWithPassword({email:r,password:b});if(d){console.error("Login error:",d.message),t("Login failed. Please check your email and password.");return}console.log("User authenticated successfully");const{data:s,error:g}=await a.supabase.from("users").select("first_name, last_name, role").eq("email",r).single();if(g){console.error("Error fetching user details:",g.message),t("Unable to fetch user details. Please try again.");return}console.log("User details fetched successfully:",s);const w={email:r,firstName:s.first_name,lastName:s.last_name,role:s.role};a.setUserInfo(w),console.log("Redirecting to dashboard"),n.navigate("/..dashboard")}catch(u){console.error("Unexpected error during login:",u.message),t("An unexpected error occurred. Please try again.")}}function f(){console.log("Navigating to create profile page"),n.navigate("../login")}function h(){console.log("Navigating to forgot password page"),n.navigate("../forgotpassword")}const x=()=>{console.log("Button clicked")};return e.jsxs("div",{children:[e.jsx("h1",{children:"Log ind"}),e.jsx(P,{classNames:{root:o.container},...m,children:e.jsxs("form",{onSubmit:p,id:"login-form",children:[e.jsx(y,{label:"Email",classNames:{input:o.TextWrapper,label:o.textLabel},placeholder:"Email",name:"email",required:!0}),e.jsx(C,{label:"Password",placeholder:"Adgangskode",classNames:{input:o.PasswordInput,label:o.passwordLabel},name:"password",required:!0}),l&&e.jsx("div",{style:{color:"red",marginTop:"10px"},children:l}),e.jsx(i,{type:"button",className:o.forgotButton,onClick:h,children:"Glemt adgangskode?"}),e.jsx(k,{label:"Husk mig",color:"#1098ad"}),e.jsx(i,{type:"submit",className:o.LoginButton,children:"LOG IND"}),e.jsx(i,{type:"button",className:o.registerButton,onClick:f,children:"OPRET PROFIL"}),e.jsx("button",{onClick:x,children:"Click me"})]})})]})}const V=j("/login")({component:q});function q(){return e.jsx("div",{children:e.jsx(W,{})})}export{V as Route};
