import{j as e,M,B as y,r as c,w as N,G as x,H as P}from"./index-heMRpDVZ.js";import{C as w,a as z,P as D,D as k,b as L}from"./NavbarNested-Di5WtgEb.js";import{T as n}from"./Text-B0-tc1iv.js";import{C as O}from"./FindRoomBar-Budu7sO1.js";import{S as T}from"./Space-QFPOTvJK.js";import{D as A}from"./Divider-CrTjHhEH.js";import{T as B}from"./TextInput-By_JN1YO.js";function F({opened:r,onClose:a}){return e.jsx(M,{opened:r,onClose:a,size:"lg",radius:"lg",centered:!0,padding:"xl",withCloseButton:!1,children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(y,{style:{position:"absolute",top:"-20px",right:"-20px",padding:0,minWidth:"unset",height:"unset"},variant:"subtle",color:"gray",onClick:a,children:"X"}),e.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[e.jsx("img",{src:"/booking/public/checkmark.jpg",width:40}),e.jsx(n,{fw:600,size:"lg",mb:"md",children:"Booking Bekræftet"}),e.jsx(n,{size:"sm",color:"dimmed",children:"Vi har sendt en bekræftelses mail til dig"}),e.jsx(y,{mt:"lg",color:"cyan",radius:"xl",onClick:a,children:"LUK"})]})]})})}function W({roomName:r,capacity:a,features:i,timeSlot:o,date:d}){const[s,l]=c.useState(!1),[p,g]=c.useState(!1),[u,m]=c.useState(""),[j,v]=c.useState(""),[f,S]=c.useState(""),C=N(),E=async()=>{if(!u||!j||!f){alert("Please fill in all fields.");return}const t={room_name:r,capacity:a,features:i,time_slot:o,date:d,email:j,first_name:u,phone_number:f};try{const{data:h,error:b}=await C.from("bookings").insert([t]);b?(console.error("Error booking:",b.message),alert("Failed to book the room. Please try again.")):g(!0)}catch(h){console.error("Unexpected error:",h),alert("An unexpected error occurred. Please try again.")}},I=()=>{l(!1),g(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(O,{style:{minHeight:"170px",minWidth:"500px"},shadow:"sm",padding:"lg",radius:"lg",withBorder:!0,children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(x,{justify:"left",mb:"xs",children:e.jsx(n,{fw:600,children:r})}),e.jsxs(x,{justify:"right",mb:"xs",children:[e.jsx(w,{size:20,color:"orange"}),e.jsx(n,{size:"sm",children:o}),e.jsx(z,{size:20,color:"orange"}),e.jsx(n,{size:"sm",children:d})]})]}),e.jsx(T,{h:"xl"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"1.5rem"},children:[e.jsxs(x,{gap:"xl",align:"start",children:[e.jsxs(x,{gap:"xs",align:"center",children:[e.jsx(D,{size:20}),e.jsx(n,{children:a})]}),i==null?void 0:i.map((t,h)=>e.jsxs(x,{gap:"xs",align:"center",children:[t==="Stor Skærm"&&e.jsx(k,{size:20}),t==="Lille Skærm"&&e.jsx(k,{size:20}),t==="Tavle"&&e.jsx(L,{size:20}),e.jsx(n,{children:t})]},h))]}),e.jsx(y,{color:"cyan",radius:"xl",onClick:()=>l(!0),children:"Book"})]})]}),e.jsxs(M,{opened:s,onClose:()=>l(!1),size:"lg",radius:"lg",centered:!0,padding:"xl",withCloseButton:!1,children:[e.jsxs("div",{style:{display:"flex",gap:"20px"},children:[e.jsx(y,{style:{position:"absolute",top:"10px",right:"10px",padding:0,minWidth:"unset",height:"unset"},variant:"subtle",color:"gray",onClick:()=>l(!1),children:"X"}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"5px"},children:[e.jsx(n,{size:"lg",fw:600,children:r}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"start",gap:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(w,{size:20,color:"orange"}),e.jsx(n,{children:o})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(z,{size:20,color:"orange"}),e.jsx(n,{children:d})]})]}),e.jsx(T,{h:"md"}),e.jsx(A,{orientation:"horizontal",style:{height:"15px"}}),e.jsxs(x,{gap:"lg",align:"start",children:[e.jsxs(x,{gap:"xs",align:"center",children:[e.jsx(D,{size:20}),e.jsx(n,{children:a})]}),i==null?void 0:i.map((t,h)=>e.jsxs(x,{gap:"xs",align:"center",children:[t==="Lille Skærm"&&e.jsx(k,{size:20}),t==="Stor Skærm"&&e.jsx(k,{size:20}),t==="Tavle"&&e.jsx(L,{size:20}),e.jsx(n,{children:t})]},h))]})]}),e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{children:"Navn - Booking ansvarlig"}),e.jsx(B,{placeholder:"Navn",mb:"md",radius:"xl",value:u,onChange:t=>m(t.target.value)}),e.jsx("label",{children:"E-mail - Booking ansvarlig"}),e.jsx(B,{placeholder:"Email",mb:"md",radius:"xl",value:j,onChange:t=>v(t.target.value)}),e.jsx("label",{children:"Tlf - Booking ansvarlig"}),e.jsx(B,{placeholder:"Tlf",mb:"md",radius:"xl",value:f,onChange:t=>S(t.target.value)}),e.jsx(y,{fullWidth:!0,color:"cyan",mt:"lg",radius:"xl",onClick:E,children:"BOOK NU"})]})]}),e.jsx(F,{opened:p,onClose:I})]})]})}const _=[{id:1,name:"Lokale 3.15",capacity:"2-8 pers",features:["Lille Skærm"]},{id:2,name:"Lokale 3.16",capacity:"8-10 pers",features:["Stor Skærm","Tavle"]},{id:3,name:"Lokale 3.3",capacity:"8-10 pers",features:["Stor Skærm","Tavle"]},{id:4,name:"Lokale 3.5",capacity:"2-8 pers",features:["Stor Skærm"]},{id:5,name:"Lokale 3.6",capacity:"8-10 pers",features:["Lille Skærm","Tavle"]},{id:6,name:"Lokale 3.9",capacity:"8-10 pers",features:["Stor Skærm","Tavle"]}],U=["08:00-09:00","09:00-10:00","10:00-11:00","11:00-12:00","12:00-13:00","13:00-14:00","14:00-15:00","15:00-16:00","16:00-17:00"];function G(r=new Date,a=1){const i=[],o=new Date(r);o.setMonth(o.getMonth()+a);const d=s=>s.toLocaleDateString("en-CA");for(let s=new Date(r);s<=o;s.setDate(s.getDate()+1))_.forEach(l=>{U.forEach(p=>{i.push({roomId:l.id,roomName:l.name,capacity:l.capacity,features:l.features,date:d(new Date(s)),timeSlot:p})})});return i}function J(){const{filters:r}=P(),[a,i]=c.useState([]),[o,d]=c.useState([]);return c.useEffect(()=>{const s=G(new Date,1);i(s),d(s)},[]),c.useEffect(()=>{const{selectedDate:s,selectedTimeSlots:l,selectedFeatures:p,selectedCapacity:g}=r,u=a.filter(m=>{const j=!s||m.date===s.toLocaleDateString("en-CA"),v=l.length===0||l.includes(m.timeSlot),f=p.length===0||p.every(C=>m.features.includes(C)),S=g.length===0||g.includes(m.capacity);return j&&v&&f&&S});d(u)},[r,a]),e.jsx("div",{style:{display:"grid",gap:"20px",height:"100vh",overflowY:"auto"},children:o.map((s,l)=>e.jsx(W,{roomName:s.roomName,capacity:s.capacity,features:s.features,timeSlot:s.timeSlot,date:s.date},l))})}export{J as B};
