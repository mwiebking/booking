import{r as g,j as e,B as v,c as S}from"./index-BiJi3uwm.js";import{s as r}from"./sign-up-form.module-zmKhV21F.js";import{u as k}from"./useRouteContext-xrn4Lf3c.js";import{C as T}from"./Container-Bt-b6z5W.js";import{T as l}from"./TextInput-QV-akN2t.js";import{P as f}from"./PasswordInput-CsX7s3a7.js";import{C as x}from"./Checkbox-CDLLNdRQ.js";import"./InputBase-CRZR3YvE.js";import"./Input-s0Rkpycx.js";import"./use-input-props-Sl8yNFvH.js";import"./use-resolved-styles-api-DqES57gp.js";import"./CheckIcon-GMa0bEmq.js";function R(){const t=k({from:"/signup"}),[m,s]=g.useState(""),[c,u]=g.useState("");async function b(h){h.preventDefault();const a=new FormData(document.querySelector("#signup-form")),y=a.get("firstName"),E=a.get("lastName"),o=a.get("email"),N=a.get("password"),j=a.get("phoneNumber"),P=a.get("notifyEmail")==="on",w=a.get("notifyText")==="on";s(""),u("");try{const{data:n,error:i}=await t.supabase.from("users").select("email").eq("email",o).single();if(i&&i.code!=="PGRST116"){console.error("Error checking existing user:",i.message),s("An error occurred while checking user availability. Please try again.");return}if(n){s("This email is already registered. Please log in or use a different email.");return}const{data:U,error:p}=await t.supabase.auth.signUp({email:o,password:N});if(p){console.error("Sign-up error:",p.message),s("Sign-up failed. Please try again.");return}const{data:q,error:d}=await t.supabase.from("users").insert({first_name:y,last_name:E,email:o,phone_number:j||null,role:"student",email_notifications:P,sms_notifications:w});if(d){console.error("Error saving user details:",d.message),s("Unable to save user details. Please try again.");return}u("Account created successfully! Please log in.")}catch(n){console.error("Unexpected error during sign-up:",n.message),s("An unexpected error occurred. Please try again.")}}return e.jsx("div",{children:e.jsx(T,{className:r.container,children:e.jsxs("form",{onSubmit:b,id:"signup-form",children:[e.jsx("h1",{className:r.title,children:"Opret Profil"}),e.jsx(l,{classNames:{input:r.FornavnInput,label:r.FornavnLabel},label:"First Name",placeholder:"Fornavn",name:"firstName",required:!0}),e.jsx(l,{classNames:{input:r.EfternavnInput,label:r.EfternavnLabel},label:"Last Name",placeholder:"Efternavn",name:"lastName",required:!0}),e.jsx(l,{classNames:{input:r.EmailInput,label:r.EmailLabel},label:"Email",placeholder:"Email",name:"email",required:!0}),e.jsx(f,{classNames:{input:r.PasswordInput,label:r.PasswordLabel},label:"Password",placeholder:"Adgangskode",name:"password",required:!0}),e.jsx(f,{classNames:{input:r.PasswordInput,label:r.PasswordLabel},label:"PasswordAccept",placeholder:"Bekræft adgangskode",name:"password",required:!0}),e.jsx(x,{className:r.Checkbox,color:"#1098ad",label:"Vil gerne modtage notifikationer på SMS'er",name:"notifyEmail"}),e.jsx(x,{className:r.Checkbox,color:"#1098ad",label:"Vil gerne modtage notifikationer på mail",name:"notifyText"}),m&&e.jsx("div",{style:{color:"red",marginTop:"10px"},children:m}),c&&e.jsx("div",{style:{color:"green",marginTop:"10px"},children:c}),e.jsx(v,{type:"submit",className:r.button,children:"OPRET BRUGER"})]})})})}const H=S("/signup")({component:C});function C(){return e.jsx("div",{children:e.jsx(R,{})})}export{H as Route};
