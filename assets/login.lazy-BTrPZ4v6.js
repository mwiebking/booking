import{o as h,r as x,j as e,m as b,n as j}from"./index-DuMsTGEs.js";import{u as w}from"./useRouteContext-TOtNwQ29.js";import{C as y,T as P,P as v}from"./TextInput-Bf9o_T7c.js";const E="_container_178qn_1",_={container:E};function L(){const o=w({from:"/login"}),t=h(),[n,r]=x.useState(""),d={bg:"var(--mantine-color-blue-light)",mt:"md"};async function g(p){p.preventDefault();const i=new FormData(document.querySelector("#login-form")),a=i.get("email"),f=i.get("password");r("");try{const{data:l,error:c}=await o.supabase.auth.signInWithPassword({email:a,password:f});if(c){console.error("Login error:",c.message),r("Login failed. Please check your email and password.");return}const{data:s,error:m}=await o.supabase.from("users").select("first_name, last_name, role").eq("email",a).single();if(m){console.error("Error fetching user details:",m.message),r("Unable to fetch user details. Please try again.");return}const u={email:a,firstName:s.first_name,lastName:s.last_name,role:s.role};o.setUserInfo(u),u.role==="teacher"?t("/dashboard-teacher"):t("/dashboard-student")}catch(l){console.error("Unexpected error during login:",l.message),r("An unexpected error occurred. Please try again.")}}return e.jsx("div",{children:e.jsx(y,{className:_.container,...d,children:e.jsxs("form",{onSubmit:g,id:"login-form",children:[e.jsx(P,{label:"Email",placeholder:"email@gmail.com",name:"email",required:!0}),e.jsx(v,{label:"Password",placeholder:"Your password",name:"password",required:!0}),n&&e.jsx("div",{style:{color:"red",marginTop:"10px"},children:n}),e.jsx(b,{type:"submit",children:"Login"})]})})})}const C=j("/login")({component:q});function q(){return e.jsx("div",{children:e.jsx(L,{})})}export{C as Route};
